<!DOCTYPE html>
<html>
<head>
    <title>CricketSense Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial; background: #f5f6fa; margin: 20px; }
        .card { background: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; }
        select { padding: 8px; }
    </style>
</head>
<body>

<h2>üèè CricketSense ‚Äì Match Analytics Dashboard</h2>

<div class="card">
    <label>Select Match:</label>
    <select id="matchSelect" onchange="loadMatch()">
        <option value="">-- Select --</option>
        {% for m in matches %}
        <option value="{{ m.match_id }}">{{ m.team1 }} vs {{ m.team2 }}</option>
        {% endfor %}
    </select>
</div>

<div class="card" id="summary"></div>

<div class="card">
    <canvas id="runChart"></canvas>
</div>

<div class="card" id="phases"></div>

<script>
let chart;

function loadMatch() {
    const matchId = document.getElementById("matchSelect").value;
    if (!matchId) return;

    fetch(`/match/${matchId}`)
        .then(res => res.json())
        .then(data => {
            document.getElementById("summary").innerHTML =
                `<b>${data.teams}</b><br>
                 Venue: ${data.venue}<br>
                 Winner: ${data.winner}`;

            document.getElementById("phases").innerHTML =
                `<b>Phase-wise Runs</b><br>
                 Powerplay: ${data.phases.powerplay}<br>
                 Middle Overs: ${data.phases.middle}<br>
                 Death Overs: ${data.phases.death}`;

            if (chart) chart.destroy();
            chart = new Chart(document.getElementById("runChart"), {
                type: 'line',
                data: {
                    labels: data.overs,
                    datasets: [{
                        label: 'Cumulative Runs',
                        data: data.runs,
                        borderWidth: 2
                    }]
                }
            });
        });
}
</script>

</body>
</html>
