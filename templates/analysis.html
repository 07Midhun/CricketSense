{% extends "base.html" %}
{% block content %}

<h1>ðŸ“º Match Analysis Studio</h1>
<p>Select a match to view run progression and performance analysis.</p>

<div class="card">
    <h2>ðŸ—‚ Available Matches</h2>
    <ul>
        {% for m in matches %}
        <li>
            <a href="#" style="color:#4da3ff;" onclick="loadMatch({{ m.match_id }})">
                {{ m.teams }}
            </a>
        </li>
        {% endfor %}
    </ul>
</div>

<div class="card">
    <h2 id="matchTitle">ðŸ“ˆ Run Progression</h2>
    <canvas id="chart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let chart;

function loadMatch(id) {
    fetch(`/analysis/${id}`)
    .then(res => res.json())
    .then(data => {
        document.getElementById("matchTitle").innerText =
            "ðŸ“ˆ " + data.teams + " â€“ Run Progression";

        if (chart) chart.destroy();

        chart = new Chart(document.getElementById("chart"), {
            type: "line",
            data: {
                labels: data.overs,
                datasets: [{
                    label: "Cumulative Runs",
                    data: data.runs,
                    borderColor: "#4da3ff",
                    borderWidth: 3,
                    tension: 0.3
                }]
            },
            options: {
                scales: {
                    x: { title: { display: true, text: "Overs" } },
                    y: { title: { display: true, text: "Runs" } }
                }
            }
        });
    });
}
</script>

{% endblock %}
